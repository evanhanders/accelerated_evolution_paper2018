%\documentclass[iop]{emulateapj}
\documentclass[aps, pre, onecolumn, nofootinbib, notitlepage, groupedaddress, amsfonts, amssymb, amsmath, longbibliography]{revtex4-1}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{xcolor}
\hypersetup{
    colorlinks,
    linkcolor={red!50!black},
    citecolor={blue!50!black},
    urlcolor={blue!80!black}
}
\usepackage{bm}
\usepackage{natbib}
\usepackage{longtable}
\LTcapwidth=0.87\textwidth

\newcommand{\Div}[1]{\ensuremath{\nabla\cdot\left( #1\right)}}
\newcommand{\DivU}{\ensuremath{\nabla\cdot\bm{u}}}
\newcommand{\angles}[1]{\ensuremath{\left\langle #1 \right\rangle}}
\newcommand{\grad}{\ensuremath{\nabla}}
\newcommand{\RB}{Rayleigh-B\'{e}nard }
\newcommand{\stressT}{\ensuremath{\bm{\bar{\bar{\Pi}}}}}
\newcommand{\lilstressT}{\ensuremath{\bm{\bar{\bar{\sigma}}}}}
\newcommand{\nrho}{\ensuremath{n_{\rho}}}
\newcommand{\approptoinn}[2]{\mathrel{\vcenter{
	\offinterlineskip\halign{\hfil$##$\cr
	#1\propto\cr\noalign{\kern2pt}#1\sim\cr\noalign{\kern-2pt}}}}}

\newcommand{\appropto}{\mathpalette\approptoinn\relax}

\newcommand\mnras{{MNRAS}}%

\begin{document}
\author{Evan H. Anders}
\affiliation{Dept. Astrophysical \& Planetary Sciences, University of Colorado -- Boulder, Boulder, CO 80309, USA}
\affiliation{Laboratory for Atmospheric and Space Physics, Boulder, CO 80303, USA}
\author{Benjamin P. Brown}
\affiliation{Dept. Astrophysical \& Planetary Sciences, University of Colorado -- Boulder, Boulder, CO 80309, USA}
\affiliation{Laboratory for Atmospheric and Space Physics, Boulder, CO 80303, USA}
\author{Jeffrey Oishi}
\affiliation{Bates}
\title{BVP Paper}

\begin{abstract}
WOW this is a really long sentence check out this abstract I'll just keep writing words to make this at least
one line long so we know what the formatting looks like, ok?
\end{abstract}
\maketitle


\section{Introduction}
\label{sec:intro}
In numerical studies of convection, the chosen boundary conditions at the upper and lower plates
determines key quantities of the dynamics of the evolved state.
Studies of incompressible, Boussinesq, \RB convection (RBC) often
employ fixed temperature (Dirichlet) or fixed heat flux
(Neumann) boundary conditions at both plates.  
Dirichlet conditions represent plates of infinite conductivity,
whereas Neumann condition model plates of finite conductivity.  
In both cases, choosing symmetric boundary conditions maintains overall system symmetry, 
and despite evolving towards quite different thermal structures, both types of conditions
transport heat in the same manner \cite{johnston&doering2009}.

Studies of convection in stratified systems which aim to model convection 
in astrophysical systems, such as the outer envelopes of low-to-moderate mass stars 
like the Sun, often employ a mixture of these
two types of boundary conditions \cite{hurlburt&all1984, cattaneo&all1991}.  
The flux at the lower boundary is fixed, modeling
the constant energy generation of the stellar core, 
while the outer boundary condition is held at a fixed temperature,
modeling the surface of a star which must output the energy generated internally.

While this setup is a useful model for understanding natural
systems, simulations which employ this setup often suffer from a long convective transient as the thermodynamic structure
of the atmosphere relaxes to the adiabatic profile specified by the fixed temperature upper boundary condition.
This long evolution occurs on the ``Kelvin-Helmholtz,'' or thermal diffusion timescale of the atmosphere, 
$t_{\text{KH}} \approx L_z^2 / \chi$, where $L_z$ is the domain depth and $\chi$ is the thermal diffusivity.
Interesting convection happens as high values of the Rayleigh number, which scales like $\chi^{-1/2}$, such that
in the astrophysically interesting regime of high-Ra, highly stratified convection, evolving a simulation for a
KH time becomes numerically intractable.  As the Rayleigh number increases, the KH time increases while the average
timestep required to resolve the more turbulent flows decreases.  The net result is that under standard initial conditions
of hydrostatic- and thermal- equilibrium, the desired convective solution cannot be obtained and the dynamics of convection
there cannot be studied.

Knowledge of Mixing Length theory and the nature of evolved convection has been used in some 
previous studies (e.g., \cite{brandenburg&all2005}) to choose smarter initial conditions than
the hydrostatic polytropic states.  However, these assumptions work best in convective regions
which are bounded by stable layers.  In simple atmospheres where boundary layers form to meet
boundary conditions at the upper and lower edge of the atmosphere, we cannot know 
\emph{a priori} what the extent or shape of the boundary layer will be, as that must be chosen
by the convective dynamics, and specification of the proper boundary layer is essential for
placing the atmosphere along the proper adiabat.

Here we present a method for using simple boundary value problems, along with information about the evolved flow fields,
to fast-forward the slow thermal evolution of convecting simulations.  We present this method in the context of RBC, and
then demonstrate that it applies to stratified, compressible convection under a simple modification.  These methods allow
us to study the convective flows driven by the evolved thermal profile while only requiring initial value problems to run
for long enough to resolve the fast dynamical timescales of convection.


\section{Experiment} 
\label{sec:experiment}
\subsection{Incompressible, Boussinesq \RB Convection}
In studies of convection, it is natural to nondimensionalize the flows on the freefall velocity.
Under the Boussinesq approximation, where $\rho = \rho_0 (1 - \alpha T_1)$ on the gravitational term in the momentum
equation and $\rho = \rho_0$ on all other terms, the freefall velocity is $v_{\text{ff}} = \sqrt{\alpha g L^2 (dT/dz)_0}$.
where $L$ is the depth of the domain, $g$ is the gravitational acceleration, and $(dT/dz)_0$ is the initial temperature
gradient of the atmosphere, which controls the flux through the system.  The typical timescale and length scale
then relate to each other according to $t_{\text{ff}} = L/v_{\text{ff}}$.
Under this nondimensionalization, the Boussinsq, incompressible equations of motion are
\begin{gather}
\DivU = 0, 
	\label{eqn:incompressible}
\\
\frac{\partial \bm{u}}{\partial t} + \bm{u}\cdot\grad\bm{u} =
-\grad\varpi + T_1\hat{z} + \frac{\text{Pr}}{\text{Ra}}\grad^2\bm{u}, 
	\label{eqn:bouss_momentum_eqn}
\\
\frac{\partial T_1}{\partial t} + \bm{u}\cdot\grad(T_0 + T_1) = \frac{1}{\text{Pr}\,\text{Ra}}\grad^2 T_1,
	\label{eqn:bouss_energy_eqn}
\end{gather}
where
\begin{equation}
\text{Ra} = \frac{g \alpha L^4 \left(\frac{dT}{dz}\right)_0}{\nu\chi} = \frac{(L\,v_{\text{ff}})^2}{\nu\chi}, \qquad \text{Pr} = \frac{\nu}{\chi}
\end{equation}
are the nondimensional Rayleigh and Prandtl numbers, where $\nu$ is the viscous diffusivity and $\chi$ is
the thermal diffusivity.

One hallmark of Boussinesq convection is that upflows and downflows are symmetric, and thus the long time- and horizontal-
average of the velocity field is exactly zero.  Assuming that the velocity field has perfect symmetry over a long time
average, the horizontally-averaged, steady state momentum equation is just
\begin{equation}
\frac{\partial}{\partial z}\angles{\varpi} = \angles{T_1}\hat{z},
	\label{eqn:simple_momentum}
\end{equation}
where $\angles{A}$ represent the horizontal- and time- average of the quantity $A$.  Thus, in the evolved solution, the
vertical profile of the pressure perturbations are directly determined by the temperature field. 
Under the Boussinesq approximation, $\bm{u}\cdot\grad(A) = \Div{\bm{u}A}$, and thus the steady state energy equation
is just
\begin{equation}
\frac{\partial}{\partial z}\angles{w(T_0 + T_1)} = \frac{1}{\text{Pr}\text{Ra}}\frac{\partial^2}{\partial z^2} \angles{T_1}.
	\label{eqn:simple_energy}
\end{equation}
Eqns (\ref{eqn:simple_momentum}) \& (\ref{eqn:simple_energy}) combine to form a second-order ODE which specifies the
mean vertical profile of the temperature and pressure fields in the evolved solution.  These fields are completely specified
by a set of two thermal boundary conditions and the evolved 
profile of the convective flux, $F_{\text{conv}} = \angles{w(T_0 + T_1)}$.

Under the choice of mixed thermal boundary conditions ($dT_1/dz = 0$ at $z = -1/2$, $T_1 = 0$ at $z = +1/2$), the initial
atmosphere starts off with much more thermal energy ($\propto T$) than the evolved adiabatic solution pegged by the
top temperature boundary condition.  This excess energy must leave the system through the upper (fixed $T$) boundary
during the convective transient, and this results in an asymmetric flux profile during the slow thermal evolution of the
atmosphere.  Furthermore, the convective flux (and the flux at the upper boundary layer) are O(1) during the convective
transient, whereas the flux entering the atmosphere at the lower boundary is O(Ra$^{-1/2}$), so the asymmetry of the fluxes
becomes increasingly pronounced as Ra is increased into the turbulent realm. 

In order to find the evolved temperature profile of the atmosphere, the evolved profile of the convective flux must
be known.  We know that the evolved solution should be in flux equilibrium, and we know that the evolved flux through
the atmosphere is the flux entering through the bottom.  Thus, the steady-state profile of the convective flux can be
approximated as
\begin{equation}
F_{\text{conv, steady}} = F_{\text{bot}}\frac{\angles{w(T_0 + T_1)}}{\angles{w(T_0 + T_1) - \kappa \partial_z (T_0 + T_1)}}
= F_{\text{bot}}\frac{\angles{F_{\text{conv, IVP}}}}{\angles{F_{\text{tot, IVP}}}}.
\end{equation}
Or, put simply, the steady state convective flux is what you get get rid of the asymmetry in the flux profile.
This flux defined here is used in a 1D boundary value problem solve of 
eqns (\ref{eqn:simple_momentum}) \& (\ref{eqn:simple_energy}) along with the appropriate boundary values.  The solution
to that BVP is then used as new initial conditions, convection restarts, and so on.

\subsection{Fully Compressible Convection}
We study stratified convection in an ideal gas whose adiabatic index is $\gamma = 5/3$.
The initial atmospheric stratification is polytropic \cite{anders&brown2017}.
We assume a Newtonian radiative conduction term \cite{lecoanet&all2014}, and solve the
fully compressible Navier-Stokes equations of the form
\begin{gather}
\frac{\partial \ln \rho}{\partial t} + \bm{u}\cdot\grad\ln\rho + \DivU = 0
	\label{eqn:FC_continuity}
\\
\frac{D \bm{u}}{Dt} = -T\grad\ln\rho - \grad T + \bm{g} - \Div{\stressT}
	\label{eqn:FC_momentum}
\\
\frac{D T}{D t} + (\gamma-1)T\DivU = 
\frac{1}{\rho c_V}\left(\kappa\grad^2 T - [\stressT\cdot\grad]\cdot\bm{u}\right),
	\label{eqn:FC_energy}
\end{gather}
where $D/Dt \equiv \partial/\partial t + \bm{u}\cdot\grad$ and the viscous stress
tensor is defined as
\begin{equation}
\Pi_{ij} \equiv -\mu\left(\frac{\partial u_i}{\partial x_j} + \frac{\partial u_j}{\partial x_i} - \frac{2}{3}\delta_{ij
}\DivU\right)
\label{eqn:stress_tensor}
\end{equation}
and $\delta_{ij}$ is the Kronecker delta function.

\subsubsection{The Boundary Value Equations}
In studies of fully compressible convection, the flux carried by the adiabatic temperature gradient
is not available for convection.  Thus, only the flux \emph{in excess} of the adiabat will drive
convection and be carried by convection.  As such, this is the only portion of the flux which
must be examined to determine if the solution is in a converged state.  In a system with
a fixed flux boundary condition, the available superadiabatic flux is
\begin{equation}
F_{\text{avail}} = -\kappa(\grad T_0 - \grad T_{\text{ad}}) = \kappa\frac{\epsilon}{c_P}\grad T_0,
\end{equation}
which is small when $\epsilon$ is small and only requires low Mach number convective flows
to carry it.  In a perfectly evolved solution, there will be thin boundary layers in which
conduction carries this flux in addition to the adiabatic flux, but in an efficient convective
interior, convective fluxes must carry this full amount.

The BVP equations are inspired by equations of stellar modeling  \cite{paxton&all2011} but adapted to these simulations
of fully compressible convection.  Here, rather than parameterizing convection, we can get the
convective fluxes directly from our simulation adn use them to solve for the appropriate structure
of the atmosphere.  The FC BVP equations are
\begin{gather}
\frac{d M_1}{dz} = \rho_1 \\
T_0 \grad \rho_1 + T_1 \grad \rho_0 + \rho_1 g = - T_0 \grad \rho_0 - T_1 \grad \rho_1 - \rho_0 g \\
\kappa \frac{d^2 T_1}{d z^2} = -\frac{d}{dz}F_{\text{conv, z}},
\end{gather}
which ensure mass conservation, thermal equilibrium, and that the atmosphere is, on average,
in hydrostatic equilibrium.  We couple these equations with four boundary conditions (mixed
flux / temperature boundary conditions, as well as setting $M_1 = 0$ at the top and bottom
of the atmosphere).





\section{Results \& Discussion}
\label{sec:results}
Here we talk about how the solutions are different, or similar.  This includes:
\begin{enumerate}
\item Showing that the flow fields look similar
\item Showing how the temperature / flux profiles look similar/different
\item showing how Nu and Re scale with Ra in BVP / IVP.
\item showing how the PDFs of $w$, $wT$, and $T$ change.
\end{enumerate}

Then we need to make some comments about whether this is good or bad

Then we need to mention how the same thing can be done in stratified, just there you don't
assume symmetrical boundary layers.





\begin{acknowledgments}
EHA acknowledges the support of the University of Colorado's George 
Ellery Hale Graduate Student Fellowship.
This work was additionally supported by  NASA LWS grant number NNX16AC92G.  
Computations were conducted 
with support by the NASA High End Computing (HEC) Program through the NASA 
Advanced Supercomputing (NAS) Division at Ames Research Center on Pleiades
with allocations GID s1647 and GID g26133.
\end{acknowledgments}


\appendix
\section{Table of Boussinesq Runs}



\section{Table of stratified runs}


\bibliography{biblio.bib}
\end{document}
