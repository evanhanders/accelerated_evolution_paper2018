%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[aps, 11pt, singlecolumn]{revtex4-1} % Set the font size (10pt, 11pt and 12pt) and paper size (letterpaper, a4paper, etc)
\usepackage{natbib}
\bibliographystyle{apsrev}
\usepackage{setspace}

\begin{document}
\newenvironment{myquotation}{
\begin{quotation}
\itshape
}{ 
\end{quotation}
}
%----------------------------------------------------------------------------------------
%	LETTER CONTENT
%----------------------------------------------------------------------------------------
\noindent
Dear Eckart, other PRFluids editors, and anonymous referees,
$\,$\newline

\begin{singlespace}
We return a new draft of our manuscript, ``Accelerated evolution in
convective simulations,'' addressing the concerns of the referee reports.
We would like to point out a few major changes in this version of the manuscript.
A new section, ``Computational time-savings of AE'' has been added after the
results section and before the conclusion section. In this section, we directly
compare the computational cost of AE and SE for select simulations and we discuss
the computational benefits of AE.  Furthermore, the final section of our paper
is now titled ``Discussion \& Conclusions;'' we have removed a vast amount
of speculation regarding extensions of AE from this section and have added
a paragraph containing some caveats regarding challenges that users will face in
extending AE to more difficult systems.  In addition to these changes in the text,
we have added a new Fig. 2 which compares the evolution of Nu and the
mean temperature in AE and SE, and we have added some accompanying text for this
figure to the results section.  Small changes in the text throughout the paper have
been made for clarity where these changes were requested by the reports.

We feel that the clarity and scientific content of the paper have been greatly
improved by the referee reports, and we thank the referees for their honest 
critiques and attention to detail. We hope that the changes made have clarified
and cleaned up the areas of concern raised in both referee reports.  Below we
include our responses to the reports. The original text of the reports is included
in italics, and our responses follow inline in unitalicized blocks.

$\,$\newline
\noindent
Sincerely,

Evan H. Anders, Benjamin P. Brown, \& Jeffrey S. Oishi



%\end{singlespace}

\newpage
\noindent
\Large{\textbf{Response to first referee:}}\newline$\,$\newline\indent

\begin{myquotation}
This paper describes a technique for accelerating the convergence to
thermal equilibrium in convective DNS simulations where such
convergence from an initial conductive state would be long. The
technique is essentially to evolve a DNS for for a while, collect the
background state non-equilibrium fluxes, and then solve a mean field
boundary value problem with scaled version of these fluxes for a new
background state in thermal equilibrium, then use this to restart the
DNS. These, or very similar techniques, have been used by many in the
past, although to my knowledge, as the authors here also claim, they
have not been explicitly written down in a paper. The authors have
gone to the trouble of doing this, not only providing a fairly
detailed prescription of the technique, but also some evidence of its
usefulness, albeit in a very simple case where it will definitely work
which is perhaps not totally representative. I guess I think this
paper is overall worthwhile, since it provides a place for newcomers
to the business to find some potentially time-saving help, even though
the ideas are not original. I think the most important issue with this
paper is that its claims of more universal applicability are somewhat
naive. I would suggest they temper these assertions substantially.

Basic questions:

How confident can one be that the BVP puts you closer to a nonlinear
saturated state than where you were? For example, in highly nonlinear
(turbulent) problems, there may be multiple states, maybe even
multiple stable states, with different background properties. Is it
possible to guarantee that you are not putting the system into an
equilibrium but unstable state, from which an equally long evolution
to a stable state is required? For the simple problems shown here,
this is perhaps not likely, but for very high degrees of turbulence,
or situations where unknown instabilities may exist, this process may
not be so successful perhaps? This is again a factor in my hesitation
about the total applicability of this technique across many problems
beyond the one the authors present.
\end{myquotation}
We are confident that the BVP puts us closer to a nonlinear saturated state
than we were before. It is true that there may be multiple stable states, and there
is no guarantee that the BVP puts the solution into the same stable state as
SE. We have mentioned this in our conclusion.

\begin{myquotation}
Here are some more comments in chronological order, not order of
importance.

Abstract and Intro:

The authors come from an astrophysical convection background where the
Peclet number is generally high and where these techniques are useful.
They need to be careful to be clear that the convection they are
talking about is high Pe, the parameter that describes the separation
of overturning and thermal diffusion timescales. These techniques will
not be useful (or required) for low Pe number situations.
\end{myquotation}
We have reworked some text in the second paragraph of the introduction section
in order to clarify that we are discussing high Pe convection.

\begin{myquotation}
Section II.

After (4): The expression for $\Delta T_0$ assumes that the background
temperature gradient is constant, which has not been introduced yet.
\end{myquotation}
We have added a sentence before the description of our nondimensionalization
stating that the initial temperature profile is linear.

\begin{myquotation}
The sentence ``Our choice of the thermal boundary conditions in Eqn.
(9 ) was motivated by the fact that accelerated evolution is simpler
when both the thermal profile and the flux through the domain are
fixed at a boundary'' is never revisited or explained, unless I missed
it?
\end{myquotation}
We have clarified this in the second to last pargraph of section III 
(and added a forward reference to this part of the text). 

\begin{myquotation}
Section III.

The assumption after equation (10) that the convective region will NOT
change substantially is a BIG assumption that allows this technique to
work. In a situation where nonlinearities affect the extent of the
convective region (e.g. penetrative convection), or anywhere else
where the active region varies (e.g. an instability), this technique
will have problems. More on this later.

Equations (12-13): These are essentially steady state, mean field
equations, with approximated fluxes for the later (solved) state. Is
the prescription for the approximated fluxes in (11) going to work for
all problems? It does so for the case examined, but this case has a
simple background temperature gradient. Would this work for more
complicated problems, for example, with a non-constant $\partial T_0/\partial z$? What
about the cases that are NOT symmetric (i.e. periodic in the
horizontal where the mean field equations contain some other terms?
\end{myquotation}
We are fairly confident that this prescription will work for more complex
initial temperature profiles ($\text{F}_{\text{B}}$ will need to pick up some
height dependence in the defintion of $\chi$, for simple internally heated
systems, for example). It would be useful to test AE in such a case, but such
studies are beyond the scope of this work, and we leave it to future work
to determine if this method is valid in such cases.   

We are uncertain of 
how AE will work for non-symmetric, horizontally variant cases. As it fundamentally
adjusts the mean profile of the whole domain in a uniform manner, it may not be
ideal for such cases. 

Refer to the revised final section of the paper for some discussion on these
issues.

\begin{myquotation}
Last para: the authors say “proper” profile, but this is an
approximate thermodynamic background profile, essentially the first
iterate in an iteration scheme. Perhaps proper is not the right word?
\end{myquotation}
We have replaced ``proper'' with more appropriate descriptors.

\begin{myquotation}
IV:

I don’t understand ``$10^{3+2/3}$''? Why is written like this?
\end{myquotation}
To determine the Ra of our simulations, we take even sized steps in log space
(3 per decade). We have changed 3 + 2/3 to 3.67 for easier reading.


\begin{myquotation}
I am not convinced that the whole ``2D and 3D scaling laws'' section
adds anything at all to this paper. It shows that this technique can
be used but so does the single example that is interrupted by this
piece. It is somewhat interesting for the scaling laws found
themselves, but it sounds like this should be in a different paper
because there is not enough explanation to understand things totally
here. I feel like the examples before and after this section are
sufficient to make the point about the AE scheme.
\end{myquotation}
We feel that it is important to show that AE works across some swath of parameter
space, in order to demonstrate its robustness for the problem presented here.
We have trimmed the text of the scaling laws section and reduced speculation in
order to keep the paper on topic. We have also replaced Re with Pe in this
section in order to reinforce the point that we are interested in high Pe
convection (since Pr = 1, Re = Pe numerically, so only labels have changed).

\begin{myquotation}
When discussing the PDFs, the author refer to the ``modes" of the PDF?
This sounds a bit odd to me. Do they mean the peaks? The phrase
``temperature fluctuations off of the modes'' is particularly baffling!
\end{myquotation}
We have replaced ``modes'' with ``maxima'' for clarity.

\begin{myquotation}
The fact that the mean temperature profile is off by a constant factor
almost everywhere is a bit disturbing, even if the factor is small.
Does continued iteration of AE not get rid of this? If not, then this
is significant, because it would take a thermal relaxation time again
to correct this issue.
\end{myquotation}
We have added a paragraph to the ``accelerated evolution recipe'' appendix.
In it, we discuss the fact that AE can be iteratively solved until you converge
to a desired fractional percentage, and that we were only aiming for O(1\%) in this
paper.  It is true that it will likely take a thermal relaxation time to evolve 
from the 1\% off state to the true state, but that slow evolution does not
appreciably change the dynamics.

\begin{myquotation}
I felt like I wanted a section at the end of this section that
described how much the AE saved in computational time and wall time
over SE. There is a bit of it here, and some of it in the discussion,
and some more details in the appendix, which seems a bit scattered. I
would be tempted to agglomerate it all here in a separate section.
\end{myquotation}
We have added a new section V., ``Computational Time-savings of AE.''
We have combined the relevant information from the results section and the 
conclusion section previously here, and we have added some information on a few
additional runs in a new table. 

\begin{myquotation}
V.

This is the section I have most issues with.

The example performed was the most likely to succeed. The 2D cases
were essentially rolls. Were the 3D cases still essentially 2D rolls
too (since the scalings came out the same)? What about larger aspect
ratio and more turbulence cases where the dynamics would be more
complex? Keeping things smooth certainly enhances the likelihood of a
simple scaling of the nonlinear fluxes working.

I think the projections for more complicated problems mentioned are
naive. If there is any nonlinear adjustment to the convective region,
e.g. penetrative convection, then the technique is far less likely to
be simply successful in the current form. The assumption of fully
convective and thermal boundary layers remaining in place is a big
one, and this is not really acknowledged. The authors do mention
penetrative convection and do indeed say that only a stiff case would
work under these premises, but this is a bit hidden, I think, and
needs to be emphasized more. For example, the penetrative ice-water
problem even in Boussinesq would not work well with this technique I
think, since the penetrative region can deepen dramatically, and
adjust the radiative flux to match the substantially changed
convective flux.

Furthermore, the compressible case is much more danger prone than
envisioned here. I suspect that in the iteration to accelerate, any
mismatch in the fluctuations and the estimated means in the DNS will
lead to major transients in the form of sound waves, which can totally
destroy a compressible evolution by reducing the tilmestep
substantially, so this technique may have drawbacks if there is not
filtering of sound waves somehow. The authors have glossed over these
problems in their eagerness to extol the virtues of their scheme.

I think the claims of this method working in many more situations need
to be examined more thoroughly before being made so boldly here.
\end{myquotation}
We agree that our intial conclusion section was over-eager. We have 
greatly reduced the amount of text spent on speculation surrounding
extensions of the AE method, and have added a paragraph warning the
reader that not all extensions will be as simple (or guaranteed to work)
as the case studied here.

\newpage
\noindent
\Large{\textbf{Response to second referee:}}\newline$\,$\newline\indent
\begin{myquotation}
$\,$\\\vspace{-1.25cm}
\begin{enumerate}
\item The authors should provide clarification on what the following terms mean: ``thermal equilibration'', ``thermally relaxed'', and ``thermal convergence''. Also, are these terms related to statistically steady state?
\end{enumerate}
\end{myquotation}
All three of these phrases are equivalent, and we have replaced all mentions of
thermal equilibration, relaxation, and thermal convergence with ``thermal
equilibration'' or ``thermally equilibrated'' throughout the paper. This term
is explained in pargraph 2 of the introduction.
\begin{myquotation}
$\,$\\\vspace{-1.25cm}
\begin{enumerate}
\setcounter{enumi}{1}
\item What is the ``Kelvin-Helmholtz timescale''?
\end{enumerate}
\end{myquotation}
The Kelvin-Helmholtz timescale is 
$$
t_{\text{KH}} = \frac{E_g}{L},
$$
where $E_g$ is the gravitational energy in a system, and $L$ is the luminosity
(energy output / time). Basically it is a timescale that astronomers and
astrophysicists use to estimate the timescale of thermal evolution of a system 
(e.g., a star). Since the point we were trying to make is that ``the mean 
thermodynamic structure of the Sun evolves \emph{really} slowly,''
we have removed this jargon and said this more clearly in paragraph 2 of the intro.

\begin{myquotation}
$\,$\\\vspace{-1.25cm}
\begin{enumerate}
\setcounter{enumi}{2}
\item The authors note that the bootstrapping method is susceptible to hysteresis effects. They should provide examples of where such effects have been observed.
\end{enumerate}
\end{myquotation}
We misspoke. We have not specifically seen hysteresis effects (nor have we seen
this in the literature).  We meant to say that in simulations where there are
multiple solution branches (e.g., a convective roll and a shearing solution),
bootstrapping a solution on one branch to different parameters with the same
solution branches will result in a solution on the 
same solution branch. Particularly, in our own
work in stratified atmospheres, atmospheres trend toward shearing states, and then
stay stuck in those states as we bootstrap to higher Ra.

We have corrected our error and made our meaning clearer.

\begin{myquotation}
$\,$\\\vspace{-1.25cm}
\begin{enumerate}
\setcounter{enumi}{3}
\item It is true that direct numerical simulation of turbulent thermal convection is expensive. However, the highest Ra simulation run by Stevens et al. reaches a stationary state in a few hundreds of free-fall times. Hence, what is the necessity of running simulations for ``thousands or millions of free-fall times''?
\end{enumerate}
\end{myquotation}
We have added a new Fig. 2 to address this question. In general, the convective
flows and heat transport (e.g., Nu) reach their final, time-stationary mean
value very quickly (see panels (a) and (b) of Fig. 2). However, the thermal 
structure of the system can still be slowly evolving for long timescales
despite the flows being relatively statistically stationary. The purpose of
running for many, many free-fall times is to converge the thermal profile of
the domain to ensure that the full system is in a steady state.

\begin{myquotation}
$\,$\\\vspace{-1.25cm}
\begin{enumerate}
\setcounter{enumi}{4}
\item Presumably, the most important step in the “Accelerated convergence method” involves decreasing the heat flux through the top boundary so as to match it with the heat flux at the bottom boundary. This is achieved by introducing a function $\xi(z) \equiv  F_B/F_{tot}$. The following questions arise:
\begin{enumerate}
\item What is the functional form of $\xi(z)$? And where does the z-dependence come from?
\item Here, $F_{tot}$ is not really a constant, but depends on time. Hence, $\xi(z)$ should also be a function of time.
\item The ``evolved'' quantities are obtained by multiplying $\langle u \times \omega \rangle$ and $F_E$ by $\xi(z)$. Can this construction be rigorously justified? I would like the authors to provide more details on how they arrived at this step.
\end{enumerate}
\end{enumerate}
\end{myquotation}

(a) In the simple case studied in this problem, where $F_B$ is constant in time
and space, the functional form of $\xi \propto F_{tot}^{-1}$, and depends only
on the fluxes of the convective system. Since $F_{tot}$ can
have a large z-dependence (e.g., Fig. 1b), $\xi$, too, has a z-dependence. 
$\xi$ is simply a height-dependent scaling that we use to appropriately
adjust our velocity, temperature, etc.

(b) We have changed $\xi(z) \rightarrow \xi(z, t)$.

(c) Physically, $\xi$ is a scaling factor that tells us how much larger the flux
is in the interior than it should be. 
We assume that $F_{tot} \sim F_{conv} \sim w (T - \langle T \rangle )$.
As such, we assume that $\xi \propto (w^{-1/2}, (T - \langle T \rangle )^{-1/2})$,
and that scaling both the temperature fields and the temperature fluctuations 
around the mean profile will reduce the convective flux in the proper way.
We scale $\langle u\times \omega\rangle$ by $\xi$, as it is
nondimensionally of order $u^2 / L$, and so if the velocities must be multiplied
by $\sqrt{\xi}$, this term must be multiplied by $\xi$.

We cannot rigorously derive $\xi$ from first principles. Its form, and the use of
it here, are the result of our experience and familiarity with convection. 

\begin{myquotation}
$\,$\\\vspace{-1.25cm}
\begin{enumerate}
\setcounter{enumi}{5}
\item The assumption that convection at early times occupies roughly the same volume as convection in the stationary state is acceptable. However, there is also the possibility that instead of decreasing the heat flux at the top one could increase it at the bottom? The boundary condition for T1 at the bottom surface is
$$
\frac{\partial T_1}{\partial z} = 0
$$
So, the imposed heat flux at the bottom is 0.
\end{enumerate}
\end{myquotation}
Our boundary condition is that \emph{fluctuations} in the temperature derivative at the
bottom of the domain are zero. Which is to say that 
$\partial T_0 / \partial z = -1 =$ constant. We could increase the heat flux at
the bottom to match the heat flux at the top, but in that case we would be solving
a different system with a different set of boundary conditions than the ones
studied here. 

\begin{myquotation}
$\,$\\\vspace{-1.25cm}
\begin{enumerate}
\setcounter{enumi}{6}
\item Could the authors construct plots of Nu vs. t (like in figure 2) for both AE and SE starting from t = 0? I would like to understand how Nu(t) evolves with time in the AE cases.
\end{enumerate}
\end{myquotation}
We have created this plot as part of a reponse to point 4. Please refer to the
new Fig. 2 in the text.

\begin{myquotation}
$\,$\\\vspace{-1.25cm}
\begin{enumerate}
\setcounter{enumi}{7}
\item I diasgree with the authors’ statement that “Previous studies in 2D convection may have avoided these time-varying Nu states by using bootstrapping techniques...” If one were to measure Nu(t) in the interior, then the sign of Nu would fluctuate between positive and negative. However, the time average would be always be positive. (This I know from my own work.)
\end{enumerate}
\end{myquotation}
The purpose of the previous Fig. 2 (now Fig. 3) was merely to show why we have
such large error bars on Nu in our Nu v. Ra plot (Fig. 4). Our aim is to show
the nature of the flow morphologies at times of high and low heat transport;
the instantaneous sign of Nu (positive or negative) is not what we are trying
to point out.

We have clarified the discussion around the scaling laws, as requested by the
other referee report. We have removed speculative statements which aimed to
compare the scaling law of Nu found here with Nu elsewhere in order to keep
the focus of our paper on AE rather than Nu scaling for our system setup.

\begin{myquotation}
$\,$\\\vspace{-1.25cm}
\begin{enumerate}
\setcounter{enumi}{8}
\item Have the authors studied convection with fixed temperature and no-slip conditions at the top and bottom surfaces? Have they compared the AE and SE results for that case?
\end{enumerate}
\end{myquotation}
We have not. We've used no-slip at both surfaces, 
but only mixed thermal boundary conditions. 
We don't forsee major difficulties in AE being applied to fixed T boundary 
conditions, but felt that such a study was outside the scope of this work.





\end{singlespace}




\bibliography{../../biblio.bib}
\end{document}
